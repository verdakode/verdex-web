<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verdex - Rare & Unique Treasures</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <header>
        <div class="header-content">
            <img src="images/verdex-logo.png" alt="Verdex Logo" class="logo">
            <h1>Verdex</h1>
            <div id="search">
                <input type="text" id="search-bar" placeholder="Discover rare treasures...">
                <button id="search-button"><i class="fas fa-search"></i></button>
            </div>
        </div>
    </header>

    <main>
        <section id="catalog">
            <h2>Exclusive Finds</h2>
            <div class="item-grid">
                <div class="item">
                    <img src="images/seventeensquare.png" alt="Rare Item 1">
                    <h3>17 Square Puzzle</h3>
                    <p class="price">$20.00</p>
                    <button class="buy-now" data-price-id="price_1PwInWP4AzUY99eBKsTcTdzT">Acquire Now</button>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2023 Verdex. Unearthing the extraordinary.</p>
    </footer>

    <script src="https://js.stripe.com/v3/"></script>

    <script src="js/main.js"></script>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        var stripe = Stripe('pk_live_51PwDokP4AzUY99eBtVGNLQCxkX4ScKz93XdImlU9wc4uxbQ2eAO2qvPIvvi1z5YR0s5pPES84O3QWBbcFLlBX1V600cMJ8hROZ');
        document.querySelectorAll('.buy-now').forEach(function(button) {
          button.addEventListener('click', function() {
            var priceId = this.getAttribute('data-price-id');
            fetch('/create-checkout-session', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                priceId: priceId
              })
            })
            .then(function(response) {
              if (!response.ok) {
                throw new Error('Network response was not ok');
              }
              return response.json();
            })
              .then(function(session) {
                return stripe.redirectToCheckout({ sessionId: session.id });
              })
              .catch(function(error) {
                console.error('Error:', error);
                alert('There was an error processing your payment. Please try again.');
              });
          });
        });
      });
    </script>
</body>
</html>
